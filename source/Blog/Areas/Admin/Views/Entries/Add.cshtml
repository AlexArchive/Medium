@model Blog.Models.EntryInput

@Html.ValidationSummary()

<div class="validation-summary-success">
    @if (ViewBag.EntryLink != null)
    {
        <p>Your post has been published and is available <a href="@ViewBag.EntryLink">here</a>.</p>
    }

</div>

@using (Html.BeginForm())
{

    <div class="lhs">
        @Html.LabelFor(m => m.Header)
        @Html.TextBoxFor(m => m.Header)

        @Html.LabelFor(m => m.Content)
        @Html.HiddenFor(m => m.Content)
        <pre id="code-editor"></pre>

        <button type="submit" class="flat-button">Post</button>
    </div>

    <div class="rhs">

        <div class="publish-options">
            <h3>Options</h3>
            
            <label>
                @Html.CheckBoxFor(m => m.Published)
                Publish
            </label>
            
            <label>
                <p>Date: <input type="text" id="datepicker"></p>
            </label>
            
            <label>
                @Html.CheckBoxFor(m => m.Published)
                Allow Comments
            </label>


        </div>
    </div>


}

@section scripts
{
    <link href="http://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css" rel="stylesheet">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    
    <script>
        var editor = ace.edit("code-editor");
        editor.setTheme("ace/theme/textmate");
        editor.getSession().setMode("ace/mode/markdown");
        editor.getSession().setUseWrapMode(true);
        editor.setHighlightActiveLine(false);
        editor.setPrintMarginColumn(70);

        $(document).ready(function () {
            editor.getSession().setValue(document.getElementById("Content").value);

            $("form").submit(function () {
                document.getElementById("Content").value = editor.getSession().getValue();
            });

            $("#datepicker").datepicker();

        });

    </script>
}